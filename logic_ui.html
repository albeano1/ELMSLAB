<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enhanced Logic Reasoning Engine</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #bdc3c7;
        }
        
        .tab {
            padding: 12px 24px;
            background-color: #ecf0f1;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
            width: auto;
        }
        
        .tab.active {
            background-color: #3498db;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .section {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #34495e;
        }
        
        textarea, input, select {
            width: 100%;
            padding: 10px;
            border: 2px solid #bdc3c7;
            border-radius: 5px;
            font-size: 14px;
            box-sizing: border-box;
        }
        
        textarea {
            height: 60px;
            resize: vertical;
        }
        
        button {
            background-color: #3498db;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-top: 10px;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        /* Enhanced Temporal Logic Result Styling */
        .temporal-result {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
        }
        
        .temporal-result h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        
        .temporal-result h4 {
            color: #34495e;
            margin: 15px 0 10px 0;
            font-size: 16px;
        }
        
        .formula-display {
            background-color: #f8f9fa;
            padding: 12px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
            margin-bottom: 20px;
        }
        
        .formula-display code {
            background-color: #e9ecef;
            padding: 4px 8px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            color: #2c3e50;
        }
        
        .main-formula {
            background-color: #e3f2fd !important;
            padding: 8px 12px !important;
            border: 2px solid #2196f3 !important;
            font-size: 18px !important;
            font-weight: bold !important;
        }
        
        /* Binary Operator Display Styles */
        .binary-operator-section {
            background-color: #fff3e0;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #ff9800;
            margin: 15px 0;
        }
        
        .binary-operator-display {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .left-formula, .right-formula {
            flex: 1;
            min-width: 200px;
            text-align: center;
        }
        
        .formula-label {
            display: block;
            font-weight: bold;
            color: #e65100;
            margin-bottom: 8px;
            font-size: 14px;
        }
        
        .formula-code {
            background-color: #fff8e1;
            padding: 10px 15px;
            border-radius: 5px;
            border: 2px solid #ff9800;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
            color: #e65100;
            display: block;
            word-break: break-all;
        }
        
        .operator-symbol {
            background-color: #ff9800;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            flex-shrink: 0;
        }
        
        .interpretation {
            background-color: #f3e5f5;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #9c27b0;
            margin-top: 10px;
            font-style: italic;
            color: #4a148c;
        }
        
        /* Timeline Validation Result Styles */
        .timeline-result {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
        }
        
        .timeline-result h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
        }
        
        .validation-display {
            background-color: #f8f9fa;
            padding: 12px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
            margin-bottom: 15px;
        }
        
        .issue-display, .confidence-display, .answer-display {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
        }
        
        .answer-display {
            background-color: #e8f4fd;
            border: 2px solid #3498db;
            font-size: 1.1em;
            font-weight: bold;
        }
        
        .events-section, .formulas-section, .reasoning-section {
            margin: 15px 0;
        }
        
        .events-list, .formulas-list {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #27ae60;
        }
        
        .event-item, .formula-item {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .event-item:last-child, .formula-item:last-child {
            border-bottom: none;
        }
        
        .event-number, .formula-number {
            font-weight: bold;
            color: #2c3e50;
            margin-right: 10px;
        }
        
        .event-text {
            color: #34495e;
        }
        
        .formula-code {
            background-color: #e9ecef;
            padding: 4px 8px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #2c3e50;
        }
        
        /* Temporal Inference Result Styles */
        .temporal-inference-result {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
        }
        
        .temporal-inference-result h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            border-bottom: 2px solid #e74c3c;
            padding-bottom: 5px;
        }
        
        .inference-display {
            background-color: #f8f9fa;
            padding: 12px;
            border-radius: 5px;
            border-left: 4px solid #e74c3c;
            margin-bottom: 15px;
        }
        
        .premises-section, .query-section, .formulas-section, .issues-section, .reasoning-section {
            margin: 15px 0;
        }
        
        .premises-list {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #27ae60;
        }
        
        .premise-item {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .premise-item:last-child {
            border-bottom: none;
        }
        
        .premise-number {
            font-weight: bold;
            color: #2c3e50;
            margin-right: 10px;
        }
        
        .premise-text {
            color: #34495e;
        }
        
        .query-item {
            background-color: #fff3cd;
            padding: 12px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
            font-weight: bold;
            color: #856404;
        }
        
        .issues-section {
            background-color: #f8d7da;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #dc3545;
        }
        
        .issues-list {
            margin-top: 10px;
        }
        
        .issue-item {
            padding: 5px 0;
            color: #721c24;
        }
        
        .valid {
            color: #28a745;
            font-weight: bold;
        }
        
        .invalid {
            color: #dc3545;
            font-weight: bold;
        }
        
        .components-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .component-item {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #27ae60;
        }
        
        .component-label {
            font-weight: bold;
            color: #2c3e50;
            text-transform: capitalize;
        }
        
        .component-value {
            color: #27ae60;
            font-family: 'Courier New', monospace;
            margin-left: 8px;
        }
        
        .alternatives-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
        }
        
        .alternative-item {
            background-color: #f8f9fa;
            padding: 12px;
            border-radius: 5px;
            border-left: 3px solid #e74c3c;
        }
        
        .alternative-label {
            font-weight: bold;
            color: #2c3e50;
            display: block;
            margin-bottom: 5px;
        }
        
        .alternative-value {
            background-color: #e9ecef;
            padding: 6px 10px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #2c3e50;
            display: block;
            word-break: break-all;
        }
        
        .valid {
            background-color: #d5f4e6;
            color: #27ae60;
            border: 2px solid #27ae60;
        }
        
        .invalid {
            background-color: #fadbd8;
            color: #e74c3c;
            border: 2px solid #e74c3c;
        }
        
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 2px solid #dc3545;
        }
        
        .loading {
            background-color: #fff3cd;
            color: #856404;
            border: 2px solid #ffc107;
        }
        
        .success {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 2px solid #17a2b8;
        }
        
        .details {
            margin-top: 15px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
            font-size: 12px;
        }
        
        .premise-container {
            margin-bottom: 10px;
        }
        
        .add-premise {
            background-color: #95a5a6;
            font-size: 14px;
            padding: 8px 16px;
            margin-top: 5px;
        }
        
        .remove-premise {
            background-color: #e74c3c;
            font-size: 12px;
            padding: 5px 10px;
            margin-left: 10px;
            width: auto;
        }
        
        .example-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .example-btn {
            background-color: #17a2b8;
            font-size: 14px;
            padding: 8px 16px;
            width: auto;
            margin: 0;
        }
        
        .example-btn:hover {
            background-color: #138496;
        }
        
        .knowledge-facts {
            max-height: 200px;
            overflow-y: auto;
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
        }
        
        .fact-item {
            padding: 5px;
            border-bottom: 1px solid #dee2e6;
            font-size: 12px;
        }
        
        .fact-item:last-child {
            border-bottom: none;
        }
        
        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .add-all-btn {
            background-color: #27ae60;
            font-size: 16px;
            padding: 12px 24px;
            width: auto;
            margin: 10px 0;
        }
        
        .add-all-btn:hover {
            background-color: #229954;
        }
        
        .facts-display {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #3498db;
            margin: 15px 0;
        }
        
        .fact-list-item {
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
            font-size: 14px;
        }
        
        .fact-list-item:last-child {
            border-bottom: none;
        }
        
        .fact-number {
            font-weight: bold;
            color: #2c3e50;
            margin-right: 10px;
        }
        
        @media (max-width: 768px) {
            .two-column {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧠 Enhanced Logic Reasoning Engine</h1>
        <p style="text-align: center; color: #7f8c8d; margin-bottom: 30px;">
            Supports Propositional Logic, First-Order Logic, Temporal Logic, and Knowledge Base
        </p>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('inference')">🔍 Logical Inference</button>
            <button class="tab" onclick="switchTab('knowledge')">📚 Knowledge Base</button>
            <button class="tab" onclick="switchTab('temporal')">⏰ Temporal Logic</button>
            <button class="tab" onclick="switchTab('convert')">🔄 Convert Text</button>
        </div>
        
        <!-- Logical Inference Tab -->
        <div id="inference-tab" class="tab-content active">
            <div class="section">
                <h2>Premises:</h2>
                <div id="premises-container">
                    <div class="premise-container">
                        <label>Premise 1:</label>
                        <textarea id="premise1" placeholder="e.g., All humans are mortal">All humans are mortal</textarea>
                    </div>
                    <div class="premise-container">
                        <label>Premise 2:</label>
                        <textarea id="premise2" placeholder="e.g., Socrates is human">Socrates is human</textarea>
                    </div>
                </div>
                <button class="add-premise" onclick="addPremise()">+ Add Premise</button>
            </div>
            
            <div class="section">
                <h2>Conclusion:</h2>
                <textarea id="conclusion" placeholder="e.g., Socrates is mortal">Socrates is mortal</textarea>
            </div>
            
            <div class="section">
                <label for="logicType">Logic Type:</label>
                <select id="logicType">
                    <option value="auto">Auto-detect (Recommended)</option>
                    <option value="propositional">Propositional Logic</option>
                    <option value="first_order">First-Order Logic</option>
                    <option value="temporal">Temporal Logic</option>
                </select>
            </div>
            
            <button onclick="checkInference()" id="checkButton">🔍 Check Validity</button>
            
            <div class="section">
                <h3>Quick Examples:</h3>
                <div class="example-buttons">
                    <button class="example-btn" onclick="loadExample('socrates')">Socrates Example</button>
                    <button class="example-btn" onclick="loadExample('business')">Business FOL</button>
                    <button class="example-btn" onclick="loadExample('birds')">Birds Example</button>
                    <button class="example-btn" onclick="loadExample('propositional')">Propositional Logic</button>
                    <button class="example-btn" onclick="loadExample('existential')">Existential Quantifier</button>
                    <button class="example-btn" onclick="loadExample('relations')">Relations</button>
                </div>
                <p><em>💡 For temporal logic (until, duration, since, etc.), use the "Temporal Inference" tab above!</em></p>
                <p><em>🔍 <strong>Logic Types:</strong> Propositional (P ∧ Q → R) | First-Order (∀x(P(x) → Q(x))) | Temporal (P U Q)</em></p>
            </div>
        </div>
        
        <!-- Knowledge Base Tab -->
        <div id="knowledge-tab" class="tab-content">
            <div class="two-column">
                <div>
                    <h2>📚 Add Facts to Knowledge Base</h2>
                    <div class="section">
                        <label for="factInput">Fact:</label>
                        <textarea id="factInput" placeholder="e.g., All birds have wings">All birds have wings</textarea>
                        <button onclick="addFact()" id="addFactButton">+ Add Fact</button>
                    </div>
                    
                    <div class="section">
                        <h3>🧪 Knowledge Base Test Scenarios:</h3>
                        <div class="example-buttons">
                            <button class="example-btn" onclick="loadKnowledgeScenario('socrates')">1. Socrates Classic</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('bird_problem')">2. Bird Problem</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('company_access')">3. Company Access</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('software_deps')">4. Software Dependencies</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('contradiction')">5. Contradiction Detection</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('academic_prereq')">6. Academic Prerequisites</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('time_based')">7. Time-Based Rules</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('ecommerce')">8. E-Commerce Rules</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('legal_compliance')">9. Legal Compliance</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('medical_diagnosis')">10. Medical Diagnosis</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('murderer_puzzle')">11. Murderer Puzzle</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('circular_dependency')">12. Circular Dependency</button>
                            <button class="example-btn" onclick="loadKnowledgeScenario('existential_queries')">13. Existential Queries</button>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h2>🔍 Query Knowledge Base</h2>
                    <div class="section">
                        <label for="queryInput">Question:</label>
                        <textarea id="queryInput" placeholder="e.g., Does Tweety have wings?">Does Tweety have wings?</textarea>
                        <button onclick="queryKnowledge()" id="queryButton">🔍 Query</button>
                    </div>
                    
                    <div class="section">
                        <h3>🎯 Test Queries:</h3>
                        <div class="example-buttons">
                            <button class="example-btn" onclick="loadQueryScenario('socrates')">Is Socrates mortal?</button>
                            <button class="example-btn" onclick="loadQueryScenario('penguins_wings')">Do penguins have wings?</button>
                            <button class="example-btn" onclick="loadQueryScenario('sarah_badge')">Does Sarah need a badge?</button>
                            <button class="example-btn" onclick="loadQueryScenario('service_failure')">Is Service A working?</button>
                            <button class="example-btn" onclick="loadQueryScenario('consistent_rules')">Are the rules consistent?</button>
                            <button class="example-btn" onclick="loadQueryScenario('alice_graduate')">Can Alice graduate?</button>
                            <button class="example-btn" onclick="loadQueryScenario('john_overtime')">Does John get overtime pay?</button>
                            <button class="example-btn" onclick="loadQueryScenario('customer_shipping')">Does Customer C get free shipping?</button>
                            <button class="example-btn" onclick="loadQueryScenario('dpo_required')">Do we need a Data Protection Officer?</button>
                            <button class="example-btn" onclick="loadQueryScenario('patient_flu')">Might Patient P have flu?</button>
                            <button class="example-btn" onclick="loadQueryScenario('murderer')">Who is the murderer?</button>
                            <button class="example-btn" onclick="loadQueryScenario('circular_job')">Can someone get a job?</button>
                            <button class="example-btn" onclick="loadQueryScenario('some_birds_swim')">Can some birds swim?</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h3>📋 Current Knowledge Base Facts:</h3>
                <button class="example-btn" onclick="loadAllFacts()" style="width: auto; margin-bottom: 10px;">🔄 Refresh Facts</button>
                <button class="example-btn" onclick="clearKnowledge()" style="width: auto; margin-bottom: 10px; background-color: #e74c3c;">🗑️ Clear All</button>
                <div id="knowledgeFacts" class="knowledge-facts">
                    <div class="fact-item">Click "Refresh Facts" to load current knowledge base...</div>
                </div>
            </div>
        </div>
        
        <!-- Enhanced Temporal Logic Tab -->
        <div id="temporal-tab" class="tab-content">
            <div class="section">
                <h2>⏰ Enhanced Temporal Logic Converter</h2>
                <p><strong>NEW:</strong> Preserves all semantic information (subject, action, destination, temporal context) and provides multiple logic representations!</p>
                <label for="temporalInput">Text with temporal expressions:</label>
                <textarea id="temporalInput" placeholder="e.g., I will go to school tomorrow">I will go to school tomorrow</textarea>
                <button onclick="convertTemporal()" id="temporalButton">⏰ Convert to Enhanced Temporal Logic</button>
            </div>
            
            <div class="section">
                <h3>Enhanced Temporal Logic Examples:</h3>
                <div class="example-buttons">
                    <button class="example-btn" onclick="loadTemporalExample('past')">Past Events</button>
                    <button class="example-btn" onclick="loadTemporalExample('future')">Future Events</button>
                    <button class="example-btn" onclick="loadTemporalExample('always')">Always/Eventually</button>
                    <button class="example-btn" onclick="loadTemporalExample('conditional')">Temporal Conditionals</button>
                    <button class="example-btn" onclick="loadTemporalExample('until')">Until Operators</button>
                    <button class="example-btn" onclick="loadTemporalExample('duration')">Duration Reasoning</button>
                    <button class="example-btn" onclick="loadTemporalExample('since')">Since Operator</button>
                    <button class="example-btn" onclick="loadTemporalExample('now')">Present Tense</button>
                </div>
                <p><em>Try these examples to see the dramatic improvement from simple "Future(go)" to comprehensive temporal logic with component extraction!</em></p>
            </div>
            
            <div class="section">
                <h2>🔗 Timeline Validator</h2>
                <p><strong>NEW:</strong> Check if a sequence of events is temporally consistent!</p>
                <label for="timelineEvents">Events (one per line):</label>
                <textarea id="timelineEvents" placeholder="e.g., Meeting A happens before Meeting B&#10;Meeting B happens before Meeting C&#10;Meeting C happens before Meeting A" rows="4">Meeting A happens before Meeting B
Meeting B happens before Meeting C
Meeting C happens before Meeting A</textarea>
                <button onclick="validateTimeline()" id="timelineButton">🔍 Validate Timeline</button>
            </div>
            
            <div class="section">
                <h2>🧠 Temporal Inference</h2>
                <p><strong>NEW:</strong> Check temporal consistency and reasoning!</p>
                <div class="two-column">
                    <div>
                        <label for="temporalPremises">Premises (one per line):</label>
                        <textarea id="temporalPremises" placeholder="e.g., I will study until the exam starts&#10;The exam starts at 2pm&#10;It is now 1pm" rows="4">I will study until the exam starts
The exam starts at 2pm
It is now 1pm</textarea>
                    </div>
                    <div>
                        <label for="temporalQuery">Query:</label>
                        <textarea id="temporalQuery" placeholder="e.g., Am I studying now?" rows="2">Am I studying now?</textarea>
                    </div>
                </div>
                <button onclick="temporalInference()" id="temporalInferenceButton">🧠 Check Temporal Inference</button>
            </div>
            
            <div class="section">
                <h3>Timeline & Inference Examples:</h3>
                <div class="example-buttons">
                    <button class="example-btn" onclick="loadTimelineExample('circular')">Circular Dependency</button>
                    <button class="example-btn" onclick="loadTimelineExample('valid')">Valid Timeline</button>
                    <button class="example-btn" onclick="loadTemporalInferenceExample('study_until')">Until Semantics</button>
                    <button class="example-btn" onclick="loadTemporalInferenceExample('duration_reasoning')">Duration Reasoning</button>
                    <button class="example-btn" onclick="loadTemporalInferenceExample('multiple_until')">Multiple Until</button>
                    <button class="example-btn" onclick="loadTemporalInferenceExample('nested_temporal')">Nested Temporal</button>
                    <button class="example-btn" onclick="loadTemporalInferenceExample('since_operator')">Since Operator</button>
                    <button class="example-btn" onclick="loadTemporalInferenceExample('scheduling_conflict')">Scheduling Conflict</button>
                </div>
                <p><em>🎯 This tab handles advanced temporal reasoning with until, duration, since, and scheduling logic!</em></p>
            </div>
        </div>
        
        <!-- Convert Text Tab -->
        <div id="convert-tab" class="tab-content">
            <div class="section">
                <h2>🔄 Convert Natural Language to Logic</h2>
                <label for="convertInput">Text to convert:</label>
                <textarea id="convertInput" placeholder="e.g., If it rains then the ground is wet">If it rains then the ground is wet</textarea>
                
                <label for="convertLogicType">Logic Type:</label>
                <select id="convertLogicType">
                    <option value="auto">Auto-detect (Recommended)</option>
                    <option value="propositional">Propositional Logic</option>
                    <option value="first_order">First-Order Logic</option>
                    <option value="temporal">Temporal Logic</option>
                </select>
                
                <button onclick="convertText()" id="convertButton">🔄 Convert</button>
            </div>
            
            <div class="section">
                <h3>Conversion Examples:</h3>
                <div class="example-buttons">
                    <button class="example-btn" onclick="loadConvertExample('propositional')">Propositional</button>
                    <button class="example-btn" onclick="loadConvertExample('first_order')">First-Order</button>
                    <button class="example-btn" onclick="loadConvertExample('temporal')">Temporal</button>
                    <button class="example-btn" onclick="loadConvertExample('mixed')">Mixed Types</button>
                </div>
            </div>
        </div>
        
        <div id="result"></div>
    </div>

    <script>
        let premiseCount = 2;
        
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            // Remove active class from all tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            
            // Show selected tab content
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }
        
        // Inference functionality
        function addPremise() {
            premiseCount++;
            const container = document.getElementById('premises-container');
            const newPremise = document.createElement('div');
            newPremise.className = 'premise-container';
            newPremise.innerHTML = `
                <label>Premise ${premiseCount}:</label>
                <textarea id="premise${premiseCount}" placeholder="e.g., Another premise"></textarea>
                <button class="remove-premise" onclick="removePremise(this)">Remove</button>
            `;
            container.appendChild(newPremise);
        }
        
        function removePremise(button) {
            button.parentElement.remove();
        }
        
        async function checkInference() {
            const resultDiv = document.getElementById('result');
            const checkButton = document.getElementById('checkButton');
            
            // Get premises
            const premises = [];
            for (let i = 1; i <= premiseCount; i++) {
                const premise = document.getElementById(`premise${i}`);
                if (premise && premise.value.trim()) {
                    premises.push(premise.value.trim());
                }
            }
            
            const conclusion = document.getElementById('conclusion').value.trim();
            
            if (premises.length === 0) {
                showResult('Please enter at least one premise.', 'error');
                return;
            }
            
            if (!conclusion) {
                showResult('Please enter a conclusion.', 'error');
                return;
            }
            
            // Show loading
            checkButton.disabled = true;
            showResult('Checking inference...', 'loading');
            
            try {
                const logicType = document.getElementById('logicType').value;
                const response = await fetch('http://127.0.0.1:8000/infer', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        premises: premises,
                        conclusion: conclusion,
                        logic_type: logicType
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                
                if (result.valid === true) {
                    showResult(
                        `✅ Valid inference! (${result.logic_type || 'Unknown type'})`,
                        'valid',
                        result
                    );
                } else if (result.valid === false) {
                    showResult(
                        `❌ Invalid inference! (${result.logic_type || 'Unknown type'})`,
                        'invalid',
                        result
                    );
                } else if (result.valid === "unknown") {
                    showResult(
                        `🔍 First-order logic inference detected (requires advanced theorem proving)`,
                        'loading',
                        result
                    );
                } else {
                    showResult(
                        `❓ Inference result: ${result.valid || 'Unknown'}`,
                        'error',
                        result
                    );
                }
                
            } catch (error) {
                showResult(`Error: ${error.message}`, 'error');
            } finally {
                checkButton.disabled = false;
            }
        }
        
        // Knowledge Base functionality
        async function addFact() {
            const factInput = document.getElementById('factInput');
            const addButton = document.getElementById('addFactButton');
            const fact = factInput.value.trim();
            
            if (!fact) {
                showResult('Please enter a fact.', 'error');
                return;
            }
            
            addButton.disabled = true;
            showResult('Adding fact...', 'loading');
            
            try {
                const response = await fetch('http://127.0.0.1:8000/knowledge/add', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        fact: fact
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                showResult(`✅ Fact added: ${result.message}`, 'success');
                factInput.value = '';
                loadAllFacts(); // Refresh the facts list
                
            } catch (error) {
                showResult(`Error: ${error.message}`, 'error');
            } finally {
                addButton.disabled = false;
            }
        }
        
        async function queryKnowledge() {
            const queryInput = document.getElementById('queryInput');
            const queryButton = document.getElementById('queryButton');
            const question = queryInput.value.trim();
            
            if (!question) {
                showResult('Please enter a question.', 'error');
                return;
            }
            
            queryButton.disabled = true;
            showResult('Querying knowledge base...', 'loading');
            
            try {
                const response = await fetch('http://127.0.0.1:8000/knowledge/query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        question: question
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                
                let resultClass = 'success';
                let resultIcon = '✅';
                if (result.answer === 'Unknown') {
                    resultClass = 'loading';
                    resultIcon = '❓';
                } else if (result.answer === 'No') {
                    resultClass = 'invalid';
                    resultIcon = '❌';
                }
                
                showResult(
                    `${resultIcon} ${result.answer}`,
                    resultClass,
                    {
                        reasoning: result.reasoning,
                        confidence: result.confidence,
                        relevant_facts: result.relevant_facts
                    }
                );
                
            } catch (error) {
                showResult(`Error: ${error.message}`, 'error');
            } finally {
                queryButton.disabled = false;
            }
        }
        
        async function loadAllFacts() {
            try {
                const response = await fetch('http://127.0.0.1:8000/knowledge/facts');
                const result = await response.json();
                
                const factsDiv = document.getElementById('knowledgeFacts');
                if (result.facts && result.facts.length > 0) {
                    factsDiv.innerHTML = result.facts.map(fact => 
                        `<div class="fact-item">
                            <strong>${fact.text}</strong><br>
                            <small>→ ${fact.formula} (${fact.formula_type})</small>
                        </div>`
                    ).join('');
                } else {
                    factsDiv.innerHTML = '<div class="fact-item">No facts in knowledge base yet.</div>';
                }
            } catch (error) {
                document.getElementById('knowledgeFacts').innerHTML = 
                    '<div class="fact-item">Error loading facts: ' + error.message + '</div>';
            }
        }
        
        async function clearKnowledge() {
            if (!confirm('Are you sure you want to clear all facts from the knowledge base?')) {
                return;
            }
            
            try {
                const response = await fetch('http://127.0.0.1:8000/knowledge/clear', {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    showResult('✅ Knowledge base cleared successfully.', 'success');
                    loadAllFacts();
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
            } catch (error) {
                showResult(`Error: ${error.message}`, 'error');
            }
        }
        
        async function addAllFacts(facts) {
            if (!facts || facts.length === 0) {
                showResult('No facts to add.', 'error');
                return;
            }
            
            showResult(`Adding ${facts.length} facts to knowledge base...`, 'loading');
            
            let successCount = 0;
            let errorCount = 0;
            const errors = [];
            
            for (let i = 0; i < facts.length; i++) {
                try {
                    const response = await fetch('http://127.0.0.1:8000/knowledge/add', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            fact: facts[i]
                        })
                    });
                    
                    if (response.ok) {
                        successCount++;
                    } else {
                        errorCount++;
                        errors.push(`Fact ${i + 1}: HTTP ${response.status}`);
                    }
                } catch (error) {
                    errorCount++;
                    errors.push(`Fact ${i + 1}: ${error.message}`);
                }
            }
            
            if (errorCount === 0) {
                showResult(`✅ Successfully added all ${successCount} facts to the knowledge base!`, 'success');
            } else if (successCount > 0) {
                showResult(`⚠️ Added ${successCount} facts successfully, but ${errorCount} failed. Errors: ${errors.join(', ')}`, 'loading');
            } else {
                showResult(`❌ Failed to add any facts. Errors: ${errors.join(', ')}`, 'error');
            }
            
            // Refresh the facts display
            loadAllFacts();
        }
        
        // Enhanced Temporal Logic functionality
        async function convertTemporal() {
            const temporalInput = document.getElementById('temporalInput');
            const temporalButton = document.getElementById('temporalButton');
            const text = temporalInput.value.trim();
            
            if (!text) {
                showResult('Please enter text to convert.', 'error');
                return;
            }
            
            temporalButton.disabled = true;
            showResult('Converting to enhanced temporal logic...', 'loading');
            
            try {
                const response = await fetch('http://127.0.0.1:8000/convert', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        text: text,
                        mode: 'temporal'
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                
                // Enhanced display for temporal logic results with better formatting
                let resultText = `<div class="temporal-result">
                    <h3>⏰ Enhanced Temporal Logic Result</h3>
                    <div class="formula-display">
                        <strong>Temporal Formula:</strong> <code class="main-formula">${result.temporal_formula}</code>
                    </div>`;
                
                // Special display for "until" binary operators
                if (result.components && result.components.temporal_operator === 'until') {
                    resultText += `<div class="binary-operator-section">
                        <h4>🔗 Binary 'Until' Operator</h4>
                        <div class="binary-operator-display">
                            <div class="left-formula">
                                <span class="formula-label">Left Side:</span>
                                <code class="formula-code">${result.components.left_formula}</code>
                            </div>
                            <div class="operator-symbol">U</div>
                            <div class="right-formula">
                                <span class="formula-label">Right Side:</span>
                                <code class="formula-code">${result.components.right_formula}</code>
                            </div>
                        </div>
                        <div class="interpretation">
                            <strong>Interpretation:</strong> ${result.components.interpretation}
                        </div>
                    </div>`;
                }
                
                resultText += `<div class="components-section">
                        <h4>📊 Component Breakdown</h4>
                        <div class="components-grid">`;
                
                if (result.components) {
                    for (const [key, value] of Object.entries(result.components)) {
                        // Skip binary operator specific fields as they're displayed above
                        if (key === 'left_formula' || key === 'right_formula' || key === 'operator' || key === 'interpretation') {
                            continue;
                        }
                        resultText += `<div class="component-item">
                            <span class="component-label">${key.replace('_', ' ')}:</span>
                            <span class="component-value">${value}</span>
                        </div>`;
                    }
                }
                
                resultText += `</div></div>`;
                
                if (result.alternative_representations) {
                    resultText += `<div class="alternatives-section">
                        <h4>🔄 Alternative Representations</h4>
                        <div class="alternatives-grid">`;
                    for (const [key, value] of Object.entries(result.alternative_representations)) {
                        resultText += `<div class="alternative-item">
                            <span class="alternative-label">${key.toUpperCase()}:</span>
                            <code class="alternative-value">${value}</code>
                        </div>`;
                    }
                    resultText += `</div></div>`;
                }
                
                resultText += `</div>`;
                
                showResult(
                    resultText,
                    'success',
                    {
                        confidence: result.confidence,
                        reasoning: result.reasoning,
                        components: result.components,
                        alternatives: result.alternative_representations
                    }
                );
                
            } catch (error) {
                showResult(`Error: ${error.message}`, 'error');
            } finally {
                temporalButton.disabled = false;
            }
        }
        
        // Timeline Validator functionality
        async function validateTimeline() {
            const timelineEvents = document.getElementById('timelineEvents');
            const timelineButton = document.getElementById('timelineButton');
            const eventsText = timelineEvents.value.trim();
            
            if (!eventsText) {
                showResult('Please enter events to validate.', 'error');
                return;
            }
            
            timelineButton.disabled = true;
            showResult('Validating timeline...', 'loading');
            
            try {
                const events = eventsText.split('\n').filter(event => event.trim());
                
                const response = await fetch('http://127.0.0.1:8000/validate_timeline', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        events: events
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                
                // Enhanced display for timeline validation results
                let resultText = `<div class="timeline-result">
                    <h3>🔗 Timeline Validation Result</h3>
                    <div class="validation-display">
                        <strong>Consistent:</strong> <span class="${result.consistent ? 'valid' : 'invalid'}">${result.consistent ? '✅ Yes' : '❌ No'}</span>
                    </div>
                    <div class="issue-display">
                        <strong>Issue:</strong> ${result.issue}
                    </div>
                    <div class="confidence-display">
                        <strong>Confidence:</strong> ${(result.confidence * 100).toFixed(0)}%
                    </div>
                    
                    <div class="events-section">
                        <h4>📋 Events Analyzed</h4>
                        <div class="events-list">`;
                
                if (result.events) {
                    result.events.forEach((event, index) => {
                        resultText += `<div class="event-item">
                            <span class="event-number">${index + 1}.</span>
                            <span class="event-text">${event}</span>
                        </div>`;
                    });
                }
                
                resultText += `</div></div>`;
                
                if (result.event_formulas) {
                    resultText += `<div class="formulas-section">
                        <h4>🔬 Temporal Logic Formulas</h4>
                        <div class="formulas-list">`;
                    result.event_formulas.forEach((formula, index) => {
                        resultText += `<div class="formula-item">
                            <span class="formula-number">${index + 1}.</span>
                            <code class="formula-code">${formula}</code>
                        </div>`;
                    });
                    resultText += `</div></div>`;
                }
                
                resultText += `<div class="reasoning-section">
                    <h4>💭 Reasoning</h4>
                    <p>${result.reasoning}</p>
                </div>`;
                
                resultText += `</div>`;
                
                showResult(
                    resultText,
                    result.consistent ? 'success' : 'error',
                    {
                        consistent: result.consistent,
                        issue: result.issue,
                        confidence: result.confidence,
                        reasoning: result.reasoning
                    }
                );
                
            } catch (error) {
                showResult(`Error: ${error.message}`, 'error');
            } finally {
                timelineButton.disabled = false;
            }
        }
        
        // Temporal Inference functionality
        async function temporalInference() {
            const temporalPremises = document.getElementById('temporalPremises');
            const temporalQuery = document.getElementById('temporalQuery');
            const temporalInferenceButton = document.getElementById('temporalInferenceButton');
            
            const premisesText = temporalPremises.value.trim();
            const queryText = temporalQuery.value.trim();
            
            if (!premisesText || !queryText) {
                showResult('Please enter both premises and query.', 'error');
                return;
            }
            
            temporalInferenceButton.disabled = true;
            showResult('Analyzing temporal inference...', 'loading');
            
            try {
                const premises = premisesText.split('\n').filter(premise => premise.trim());
                
                const response = await fetch('http://127.0.0.1:8000/temporal/infer', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        premises: premises,
                        query: queryText
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                
                // Enhanced display for temporal inference results
                let resultText = `<div class="temporal-inference-result">
                    <h3>🧠 Temporal Inference Result</h3>
                    <div class="inference-display">
                        <strong>Consistent:</strong> <span class="${result.consistent ? 'valid' : 'invalid'}">${result.consistent ? '✅ Yes' : '❌ No'}</span>
                    </div>
                    <div class="confidence-display">
                        <strong>Confidence:</strong> ${(result.confidence * 100).toFixed(0)}%
                    </div>`;
                
                // Add answer display if available
                if (result.answer !== undefined) {
                    resultText += `<div class="answer-display">
                        <strong>Answer:</strong> <span class="${result.answer ? 'valid' : 'invalid'}">${result.answer ? '✅ Yes' : '❌ No'}</span>
                    </div>`;
                }
                
                resultText += `
                    
                    <div class="premises-section">
                        <h4>📋 Premises</h4>
                        <div class="premises-list">`;
                
                if (result.premises) {
                    result.premises.forEach((premise, index) => {
                        resultText += `<div class="premise-item">
                            <span class="premise-number">${index + 1}.</span>
                            <span class="premise-text">${premise}</span>
                        </div>`;
                    });
                }
                
                resultText += `</div></div>`;
                
                resultText += `<div class="query-section">
                    <h4>❓ Query</h4>
                    <div class="query-item">${result.query}</div>
                </div>`;
                
                if (result.premise_formulas) {
                    resultText += `<div class="formulas-section">
                        <h4>🔬 Temporal Logic Formulas</h4>
                        <div class="formulas-list">`;
                    result.premise_formulas.forEach((formula, index) => {
                        resultText += `<div class="formula-item">
                            <span class="formula-label">Premise ${index + 1}:</span>
                            <code class="formula-code">${formula}</code>
                        </div>`;
                    });
                    resultText += `<div class="formula-item">
                        <span class="formula-label">Query:</span>
                        <code class="formula-code">${result.query_formula}</code>
                    </div>`;
                    resultText += `</div></div>`;
                }
                
                if (result.consistency_result && result.consistency_result.issues && result.consistency_result.issues.length > 0) {
                    resultText += `<div class="issues-section">
                        <h4>⚠️ Issues Detected</h4>
                        <div class="issues-list">`;
                    result.consistency_result.issues.forEach((issue, index) => {
                        resultText += `<div class="issue-item">${index + 1}. ${issue}</div>`;
                    });
                    resultText += `</div></div>`;
                }
                
                resultText += `<div class="reasoning-section">
                    <h4>💭 Reasoning</h4>
                    <p>${result.reasoning}</p>
                </div>`;
                
                resultText += `</div>`;
                
                showResult(
                    resultText,
                    result.consistent ? 'success' : 'error',
                    {
                        consistent: result.consistent,
                        issues: result.consistency_result ? result.consistency_result.issues : [],
                        confidence: result.confidence,
                        reasoning: result.reasoning
                    }
                );
                
            } catch (error) {
                showResult(`Error: ${error.message}`, 'error');
            } finally {
                temporalInferenceButton.disabled = false;
            }
        }
        
        // Convert Text functionality
        async function convertText() {
            const convertInput = document.getElementById('convertInput');
            const convertButton = document.getElementById('convertButton');
            const text = convertInput.value.trim();
            const logicType = document.getElementById('convertLogicType').value;
            
            if (!text) {
                showResult('Please enter text to convert.', 'error');
                return;
            }
            
            convertButton.disabled = true;
            showResult('Converting text...', 'loading');
            
            try {
                const response = await fetch('http://127.0.0.1:8000/convert', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        text: text,
                        logic_type: logicType
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const result = await response.json();
                
                let formula = '';
                let resultType = '';
                
                if (result.temporal_formula) {
                    formula = result.temporal_formula;
                    resultType = 'Temporal Logic';
                } else if (result.first_order_formula) {
                    formula = result.first_order_formula;
                    resultType = 'First-Order Logic';
                } else if (result.propositional_formula) {
                    formula = result.propositional_formula;
                    resultType = 'Propositional Logic';
                } else {
                    formula = 'No formula generated';
                    resultType = 'Unknown';
                }
                
                showResult(
                    `🔄 ${resultType}: ${formula}`,
                    'success',
                    {
                        detected_logic_type: result.detected_logic_type,
                        confidence: result.confidence,
                        atoms: result.atoms,
                        note: result.note
                    }
                );
                
            } catch (error) {
                showResult(`Error: ${error.message}`, 'error');
            } finally {
                convertButton.disabled = false;
            }
        }
        
        // Example loading functions
        function loadExample(type) {
            // Clear existing premises
            const container = document.getElementById('premises-container');
            container.innerHTML = '';
            premiseCount = 0;
            
            switch(type) {
                case 'socrates':
                    addPremiseWithText('All humans are mortal');
                    addPremiseWithText('Socrates is human');
                    document.getElementById('conclusion').value = 'Socrates is mortal';
                    document.getElementById('logicType').value = 'auto';
                    break;
                case 'business':
                    addPremiseWithText('All profitable companies have increasing sales or decreasing costs');
                    addPremiseWithText('Acme is a company');
                    addPremiseWithText('Acme has increasing sales');
                    document.getElementById('conclusion').value = 'Acme might be profitable';
                    document.getElementById('logicType').value = 'first_order';
                    break;
                case 'birds':
                    addPremiseWithText('All birds can fly');
                    addPremiseWithText('Penguins are birds');
                    document.getElementById('conclusion').value = 'Penguins can fly';
                    document.getElementById('logicType').value = 'auto';
                    break;
                case 'propositional':
                    addPremiseWithText('If it rains then the ground is wet');
                    addPremiseWithText('It is raining');
                    document.getElementById('conclusion').value = 'The ground is wet';
                    document.getElementById('logicType').value = 'propositional';
                    break;
                case 'existential':
                    addPremiseWithText('Some students passed the exam');
                    addPremiseWithText('Everyone who passed gets a certificate');
                    document.getElementById('conclusion').value = 'Some students get a certificate';
                    document.getElementById('logicType').value = 'first_order';
                    break;
                case 'relations':
                    addPremiseWithText('John loves Mary');
                    addPremiseWithText('Everyone who loves someone is happy');
                    document.getElementById('conclusion').value = 'John is happy';
                    document.getElementById('logicType').value = 'first_order';
                    break;
            }
        }
        
        // Comprehensive Knowledge Base Test Scenarios
        async function loadKnowledgeScenario(type) {
            // Note: This adds facts to existing knowledge base
            // Use "Clear Knowledge Base" button if you want to start fresh
            
            const factInput = document.getElementById('factInput');
            const queryInput = document.getElementById('queryInput');
            
            // Define facts for each scenario
            const scenarios = {
                'socrates': {
                    facts: [
                        'All men are mortal',
                        'Socrates is a man'
                    ],
                    query: 'Is Socrates mortal?'
                },
                'bird_problem': {
                    facts: [
                        'All birds have wings',
                        'All birds lay eggs',
                        'Penguins are birds',
                        'Penguins cannot fly'
                    ],
                    query: 'Do penguins have wings?'
                },
                'company_access': {
                    facts: [
                        'All employees need badges to enter the building',
                        'Contractors are not employees',
                        'All managers are employees',
                        'Sarah is a manager',
                        'Tom is a contractor'
                    ],
                    query: 'Does Sarah need a badge?'
                },
                'software_deps': {
                    facts: [
                        'Service A depends on Service B',
                        'Service B depends on Service C',
                        'Service C depends on Database D',
                        'If a service depends on something that is down, the service fails',
                        'Database D is down'
                    ],
                    query: 'Is Service A working?'
                },
                'contradiction': {
                    facts: [
                        'All meetings are virtual',
                        'The board meeting requires in-person attendance',
                        'The board meeting is a meeting'
                    ],
                    query: 'Are the rules consistent?'
                },
                'academic_prereq': {
                    facts: [
                        'Students must complete Math 101 before Math 201',
                        'Students must complete Math 201 before Math 301',
                        'Students must complete Math 301 before graduating',
                        'Alice completed Math 101',
                        'Alice completed Math 201',
                        'Bob completed Math 301 but not Math 201'
                    ],
                    query: 'Can Alice graduate?'
                },
                'time_based': {
                    facts: [
                        'Employees who work more than 40 hours get overtime pay',
                        'Managers do not get overtime pay',
                        'John is an employee',
                        'John is a manager',
                        'John worked 50 hours this week'
                    ],
                    query: 'Does John get overtime pay?'
                },
                'ecommerce': {
                    facts: [
                        'Free shipping on orders over $50',
                        'Premium members get free shipping on all orders',
                        'Sales items cannot be returned',
                        'Electronics have a 30-day return window',
                        'Item X is electronics',
                        'Item X is on sale',
                        'Customer C is a premium member',
                        'Customer C\'s order is $30'
                    ],
                    query: 'Does Customer C get free shipping?'
                },
                'legal_compliance': {
                    facts: [
                        'Companies processing EU data must be GDPR compliant',
                        'GDPR compliant companies must have a Data Protection Officer',
                        'Companies with under 10 employees are exempt from DPO requirement',
                        'Our company processes EU data',
                        'Our company has 8 employees'
                    ],
                    query: 'Do we need a Data Protection Officer?'
                },
                'medical_diagnosis': {
                    facts: [
                        'Patients with fever and cough might have flu',
                        'Patients with flu should rest',
                        'Patients with severe symptoms should see a doctor immediately',
                        'Fever over 103°F is a severe symptom',
                        'Patient P has fever of 104°F',
                        'Patient P has cough'
                    ],
                    query: 'Might Patient P have flu?'
                },
                'murderer_puzzle': {
                    facts: [
                        'Someone in the mansion is the murderer',
                        'The murderer was in the library at midnight',
                        'Colonel Mustard was in the kitchen at midnight',
                        'Miss Scarlet was in the library at midnight',
                        'Professor Plum was in the study at midnight',
                        'Only one person can be in a room at a time',
                        'Only these three people were in the mansion'
                    ],
                    query: 'Who is the murderer?'
                },
                'circular_dependency': {
                    facts: [
                        'To get a job you need experience',
                        'To get experience you need a job'
                    ],
                    query: 'Can someone with neither get a job?'
                },
                'existential_queries': {
                    facts: [
                        'Some birds can swim',
                        'All penguins are birds',
                        'All penguins can swim',
                        'Robins are birds'
                    ],
                    query: 'Can some birds swim?'
                }
            };
            
            const scenario = scenarios[type];
            if (scenario) {
                // Set the query
                queryInput.value = scenario.query;
                
                // Display the facts with an "Add All Facts" button
                let factsText = `<div class="facts-display">
                    <h3>📋 Facts for this scenario:</h3>
                    <div class="facts-list">`;
                
                for (let i = 0; i < scenario.facts.length; i++) {
                    factsText += `<div class="fact-list-item">
                        <span class="fact-number">${i + 1}.</span>
                        <span class="fact-text">${scenario.facts[i]}</span>
                    </div>`;
                }
                
                factsText += `</div>
                    <div style="margin-top: 15px;">
                        <strong>❓ Query:</strong> "${scenario.query}"
                    </div>
                    <button class="add-all-btn" onclick="addAllFacts([${scenario.facts.map(fact => `'${fact.replace(/'/g, "\\'")}'`).join(', ')}])">
                        ➕ Add All ${scenario.facts.length} Facts
                    </button>
                </div>`;
                
                // Show the facts with the add all button
                showResult(factsText, 'success');
                
                // Also display in the fact input for easy copying
                factInput.value = scenario.facts[0]; // Set first fact as example
                
                // Refresh the facts display
                loadAllFacts();
            }
        }
        
        function loadQueryScenario(type) {
            const queryInput = document.getElementById('queryInput');
            switch(type) {
                case 'socrates':
                    queryInput.value = 'Is Socrates mortal?';
                    break;
                case 'penguins_wings':
                    queryInput.value = 'Do penguins have wings?';
                    break;
                case 'sarah_badge':
                    queryInput.value = 'Does Sarah need a badge?';
                    break;
                case 'service_failure':
                    queryInput.value = 'Is Service A working?';
                    break;
                case 'consistent_rules':
                    queryInput.value = 'Are the rules consistent?';
                    break;
                case 'alice_graduate':
                    queryInput.value = 'Can Alice graduate?';
                    break;
                case 'john_overtime':
                    queryInput.value = 'Does John get overtime pay?';
                    break;
                case 'customer_shipping':
                    queryInput.value = 'Does Customer C get free shipping?';
                    break;
                case 'dpo_required':
                    queryInput.value = 'Do we need a Data Protection Officer?';
                    break;
                case 'patient_flu':
                    queryInput.value = 'Might Patient P have flu?';
                    break;
                case 'murderer':
                    queryInput.value = 'Who is the murderer?';
                    break;
                case 'circular_job':
                    queryInput.value = 'Can someone with neither get a job?';
                    break;
                case 'some_birds_swim':
                    queryInput.value = 'Can some birds swim?';
                    break;
            }
        }
        
        function loadTemporalExample(type) {
            const temporalInput = document.getElementById('temporalInput');
            switch(type) {
                case 'past':
                    temporalInput.value = 'I went to school yesterday';
                    break;
                case 'future':
                    temporalInput.value = 'I will go to school tomorrow';
                    break;
                case 'always':
                    temporalInput.value = 'The sun always rises in the east';
                    break;
                case 'conditional':
                    temporalInput.value = 'If it rains tomorrow then I will stay home';
                    break;
                case 'until':
                    temporalInput.value = 'I will study until the exam starts';
                    break;
                case 'duration':
                    temporalInput.value = 'The meeting lasts 2 hours';
                    break;
                case 'since':
                    temporalInput.value = 'I have been waiting since noon';
                    break;
                case 'now':
                    temporalInput.value = 'Am I studying now?';
                    break;
            }
        }
        
        function loadConvertExample(type) {
            const convertInput = document.getElementById('convertInput');
            const convertLogicType = document.getElementById('convertLogicType');
            switch(type) {
                case 'propositional':
                    convertInput.value = 'It is sunny and warm';
                    convertLogicType.value = 'propositional';
                    break;
                case 'first_order':
                    convertInput.value = 'All students study hard';
                    convertLogicType.value = 'first_order';
                    break;
                case 'temporal':
                    convertInput.value = 'I will finish this project soon';
                    convertLogicType.value = 'temporal';
                    break;
                case 'mixed':
                    convertInput.value = 'If it rains then the ground is wet';
                    convertLogicType.value = 'auto';
                    break;
            }
        }
        
        function loadTimelineExample(type) {
            const timelineEvents = document.getElementById('timelineEvents');
            switch(type) {
                case 'circular':
                    timelineEvents.value = 'Meeting A happens before Meeting B\nMeeting B happens before Meeting C\nMeeting C happens before Meeting A';
                    break;
                case 'valid':
                    timelineEvents.value = 'Meeting A happens before Meeting B\nMeeting B happens before Meeting C';
                    break;
            }
        }
        
        function loadTemporalInferenceExample(type) {
            const temporalPremises = document.getElementById('temporalPremises');
            const temporalQuery = document.getElementById('temporalQuery');
            switch(type) {
                case 'study_until':
                    temporalPremises.value = 'I will study until the exam starts\nThe exam starts at 2pm\nIt is now 4pm';
                    temporalQuery.value = 'Am I studying now?';
                    break;
                case 'duration_reasoning':
                    temporalPremises.value = 'The meeting lasts 2 hours\nThe meeting started at 1pm\nIt is now 2:30pm';
                    temporalQuery.value = 'Is the meeting still happening?';
                    break;
                case 'multiple_until':
                    temporalPremises.value = 'The store stays open until 9pm or until supplies run out\nIt is now 8pm\nSupplies ran out at 7pm';
                    temporalQuery.value = 'Is the store open now?';
                    break;
                case 'nested_temporal':
                    temporalPremises.value = 'I will keep trying until I eventually succeed\nI have not succeeded yet\nIt is now Monday';
                    temporalQuery.value = 'Am I still trying?';
                    break;
                case 'since_operator':
                    temporalPremises.value = 'I have been waiting since noon\nIt is now 3pm';
                    temporalQuery.value = 'Am I waiting now?';
                    break;
                case 'scheduling_conflict':
                    temporalPremises.value = 'Meeting A is from 2pm to 3pm\nMeeting B is from 2:30pm to 4pm';
                    temporalQuery.value = 'Do the meetings overlap?';
                    break;
            }
        }
        
        function addPremiseWithText(text) {
            premiseCount++;
            const container = document.getElementById('premises-container');
            const newPremise = document.createElement('div');
            newPremise.className = 'premise-container';
            newPremise.innerHTML = `
                <label>Premise ${premiseCount}:</label>
                <textarea id="premise${premiseCount}" placeholder="e.g., Another premise">${text}</textarea>
                <button class="remove-premise" onclick="removePremise(this)">Remove</button>
            `;
            container.appendChild(newPremise);
        }
        
        function showResult(message, type, details = null) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = `result ${type}`;
            
            // Check if message contains HTML (for temporal logic results)
            if (message.includes('<div class="temporal-result">')) {
                resultDiv.innerHTML = message;
            } else {
                
                resultDiv.innerHTML = message;
            }
            
            if (details) {
                const detailsDiv = document.createElement('div');
                detailsDiv.className = 'details';
                
                let detailsHTML = '';
                
                if (details.logic_type) {
                    detailsHTML += `<strong>Logic Type:</strong> ${details.logic_type}<br>`;
                }
                
                if (details.detected_logic_type) {
                    detailsHTML += `<strong>Detected Type:</strong> ${details.detected_logic_type}<br>`;
                }
                
                if (details.explanation) {
                    detailsHTML += `<strong>Explanation:</strong> ${details.explanation}<br>`;
                }
                
                if (details.reasoning) {
                    detailsHTML += `<strong>Reasoning:</strong> ${details.reasoning}<br>`;
                }
                
                if (details.confidence) {
                    detailsHTML += `<strong>Confidence:</strong> ${details.confidence}<br>`;
                }
                
                if (details.premises && details.premises.length > 0) {
                    detailsHTML += `<strong>Parsed Premises:</strong><br>`;
                    details.premises.forEach((premise, index) => {
                        detailsHTML += `&nbsp;&nbsp;${index + 1}. ${premise}<br>`;
                    });
                }
                
                if (details.conclusion) {
                    detailsHTML += `<strong>Parsed Conclusion:</strong> ${details.conclusion}<br>`;
                }
                
                if (details.implication) {
                    detailsHTML += `<strong>Implication:</strong> ${details.implication}<br>`;
                }
                
                if (details.atoms && details.atoms.length > 0) {
                    detailsHTML += `<strong>Atoms:</strong> ${details.atoms.join(', ')}<br>`;
                }
                
                if (details.relevant_facts && details.relevant_facts.length > 0) {
                    detailsHTML += `<strong>Relevant Facts:</strong><br>`;
                    details.relevant_facts.forEach((fact, index) => {
                        detailsHTML += `&nbsp;&nbsp;${index + 1}. ${fact.text} → ${fact.formula}<br>`;
                    });
                }
                
                if (details.truth_table_summary) {
                    detailsHTML += `<strong>Truth Table:</strong> ` +
                        `Tautology: ${details.truth_table_summary.is_tautology}, ` +
                        `Contradiction: ${details.truth_table_summary.is_contradiction}, ` +
                        `Satisfiable: ${details.truth_table_summary.is_satisfiable}<br>`;
                }
                
                if (details.counterexample) {
                    detailsHTML += `<strong>Counterexample:</strong> ${details.counterexample.description}<br>`;
                }
                
                if (details.note) {
                    detailsHTML += `<strong>Note:</strong> ${details.note}<br>`;
                }
                
                detailsDiv.innerHTML = detailsHTML;
                resultDiv.appendChild(detailsDiv);
            }
        }
        
        // Load knowledge base facts on page load
        window.onload = function() {
            loadAllFacts();
        };
    </script>
</body>
</html>
